<!DOCTYPE html>
<html>
<head>
    <title>Ovipositor Calculator</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        var exportData;

        function importRows(attackOrDefend) {
            /** Example import format
            4_ACFU_Nope
            Cavalry
            ACFU
            Nope
            Size: 200
            Training: 20
            ...
            Alicorns are an edge case. Example format:
            UnitName
            Alicorns
            Size: 30
            Training: 20
            */

            // Check if any data provided
            var text = document.getElementById("txtImport").value;
            if (text.trim().length == 0)
                return;
    
            try {
                // Split the text into individual lines
                var parsedResults = "";
                var parsedResultsDisabled = "";
                var textLines = text.split(/\r?\n|\r/); 

                const businessArray = ["Bakery", "Basic Apple Orchard"];
                //assume not found and set 0, which will get overwritten if found
                var businessCount = 0;
                var businessCountDisabled = 0;

                businessArray.forEach(addBusiness);

                function addBusiness(item) {
                console.log(item);
                // we are already checking each business in order. now we need to find the relevant line
                for(var line = 0; line < textLines.length; line++){
                    if (textLines[line].indexOf(item) !== -1) {
                        if (textLines[line].indexOf("disabled)") !== -1) {
                            console.log("DISABLED item found:" + item + " in: " + textLines[line]);
                            console.log(textLines[line].match("\d+"));
                        } else {
                            console.log("REGULAR item found:" + item + " in: " + textLines[line]);
                        }
                    }
                }
                

                parsedResults = parsedResults + businessCount + "\n";
                }

                //for each per type of building, and line breaks
                

                //for(var line = 0; line < textLines.length; line++){
                //console.log(textLines[line])
                //}

                //var email = new RegExp('^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$');

                //if (email.test(VAL)) {
                //    alert('Great, you entered an E-Mail-address');

                // Finally, clear out the textarea upon successful import.
                document.getElementById("txtImport").value = parsedResults;
            }
            catch(err) {
                console.log(err);
                alert("Error Found.")
            }
        }

        $(document).ready(function() {
            // Import rows on bbutton click
            $('#btnImportAttackers').on("click", () => importRows.call(this, "attacker"));
        });
    </script>
</head>
<body>
        <div class="importRegion">
            <h2>Import data for Spreadsheet</h2>
            <div class="importButtons">
                <input type="button" id="btnImportAttackers" value="Import Attackers" title="Import to the attackers table" />
            </div>
            <textarea id="txtImport"></textarea>
        </div>
</body>
</html>